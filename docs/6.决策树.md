# Chapter 6.决策树

与支持向量机一样，决策树也是多功能的机器学习算法，既可以执行分类任务，也可以执行回归任务，甚至可以执行多输出任务。 它们是非常强大的算法，能够完美契合复杂的数据集。 例如，在第 2 章中，我们在加利福尼亚住房数据集上训练了一个 DecisionTreeRegressor 模型，并对其进行了完美拟合（实际上是对其进行过度拟合）。
决策树也是随机森林的基本组成部分（参见第 7 章），它是当今最强大的机器学习算法之一。
在本章中，我们将首先讨论如何使用决策树进行训练，可视化和预测。 然后快速过一遍 Scikit-Learn 中使用的 CART 训练算法，并且讨论如何调整树并将其用于回归任务。 最后，我们会讨论决策树的一些局限性。

## 训练和可视化决策树
为了理解决策树，我们只需构建一个决策树并查看它如何进行预测。 以下代码在虹膜数据集上训练决策树分类器（请参阅第4章）：

```python
from sklearn.datasets import load_iris
from sklearn.tree import DecisionTreeClassifier
iris = load_iris()
X = iris.data[:, 2:] # petal length and width y = iris.target
    tree_clf = DecisionTreeClassifier(max_depth=2)
    tree_clf.fit(X, y)
```

首先，我们可以通过使用 export_graphviz() 方法输出一个名为 iris_tree.dot 的图形定义文件来可视化已训练出来的决策树：

```python
from sklearn.tree import export_graphviz
    export_graphviz(
            tree_clf,
            out_file=image_path("iris_tree.dot"),
            feature_names=iris.feature_names[2:],
            class_names=iris.target_names,
            rounded=True,
            filled=True
        )
```

然后，w我们可以使用 graphviz 软件包中的 dot 命令行工具将此 .dot 文件转换为各种格式，例如 PDF 或 PNG 。下面的命令行将 .dot 文件转换为 .png 图像文件：

```$ dot -Tpng iris_tree.dot -o iris_tree.png```

我们的第一个决策树如图6-1所示。

![Figure6-1](https://github.com/apachecn/hands_on_Ml_with_Sklearn_and_TF/blob/Lisanaaa/images/chapter_6/Figure6-1.jpeg)
